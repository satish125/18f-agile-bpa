<div class="container" ng-controller="StoresPartialCtrl">
	<h1>Connect Stores</h1>
	<div ng-repeat="error in errors track by $index" class="clearfix">
	   <div class="alert alert-danger alert-dismissible" role="alert">
		 <button type="button" ng-click="errors.splice($index,1)" class="close" data-dismiss="alert" aria-label="Close"><span class="fa fa-close" aria-hidden="true"></span></button>
		 <ul class="fa-ul pre"><li><span class="fa-li fa fa-exclamation-triangle" aria-hidden="true"></span><span class="sr-only">Error: </span>{{error}}</li></ul>
	   </div>
	</div>

	<form class="col-md-3">
		<input type="search" class="form-control empty" id="storeSearch" ng-model="storeSearch.name" placeholder="search for store">
	</form>

	<div class="col-md-12">
		<ul class="media-list">
			<li class="media card" ng-repeat="store in getStores() | filter:storeSearch | orderBy:['-hasConnectionAttempt()','name']">
				<div class="media-left">
					<div class="store-logo-container">
						<img class="media-object" ng-src="{{store.image_link}}" alt="{{store.name}}">
					</div>
				</div>
				<div class="media-body">
					<h4 ng-show="store.isConnected()">
						CONNECTED
						<span class="fa fa-check text-success" aria-hidden="true"></span>
					</h4>
					<form name="connectForm" class="form-inline" ng-submit="doStoreConnect(store)" autocomplete="off">
						<span ng-show="!store.isConnected()">
							<div class="form-group form-control-wrapper floating-label-wrapper">
								<input style="display:none" type="text">
								<input id="username{{store.id}}" name="username{{store.id}}" type="text" class="form-control empty" ng-model="store.username" required autocomplete="off">
								<label for="username{{store.id}}" class="floating-label">user</label>
								<span class="material-input"></span>
							</div>
							<div class="form-group form-control-wrapper floating-label-wrapper">
								<input style="display:none" type="password">
								<input id="password{{store.id}}" name="password{{store.id}}" type="password" ng-model="store.password" class="form-control empty" required autocomplete="off">
								<label for="password{{store.id}}" class="floating-label">password</label>
								<span class="material-input"></span>
							</div>
							<button type="submit" class="btn btn-default btn-flat btn-tight" ng-disabled="store.isWorking()">
								<span class="fa fa-link fa-rotate-90" ng-class="store.isConnecting?'fa-spin':''" aria-hidden="true"></span> Connect
							</button>
						</span>
						<button type="button" class="btn btn-default btn-flat btn-tight" ng-show="store.hasConnectionAttempt()" ng-disabled="store.isWorking()" ng-click="doStoreDisconnect(store)">
							<span class="fa fa-unlink" ng-class="store.isDisconnecting?'fa-spin':''" aria-hidden="true"></span> Disconnect
						</button>
						<span class="label" ng-show="store.hasConnectionAttempt()" ng-class="{'label-danger':store.userStore().credentials_status==='Invalid'}">
							{{store.userStore().credentials_status}} Credentials
						</span>
					</form>
				</div>
			</li>
		</ul>
	</div>
</div>