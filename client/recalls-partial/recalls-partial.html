<div class="container-fluid" ng-controller="RecallsPartialCtrl">
    <button ng-show="progress==100" class="pull-right btn btn-default" ng-click="recheckAll()">
        <i class="fa fa-undo"></i> Recheck All
    </button>
    <h1>Recalls</h1>
    <p ng-show="progress<100">
        Checking {{num_attempted}} of {{num_purchases}} purchases.
    </p>
    <div ng-show="progress<100" class="progress progress-striped active">
        <div class="progress-bar" style="width: {{progress}}%"></div>
    </div>
    <div class="row recallsGrid">
        <div class="recall" ng-repeat="(productId, recall) in recalls"
            ng-click="toggleRecall(recall)" ng-class="{'expanded': recall.expanded}">
            <div class="card shadow-z-1 row">
                <button type="button" class="close" data-dismiss="alert" aria-label="Close"><span aria-hidden="true">&times;</span></button>
                <div class="productInfo">
                    <div class="imageBG">
                        <img ng-src="{{recall.purchase.large_image}}" alt="" />
                    </div>
                    
                    <h1>{{recall.purchase.name}}</h1>
                    <div class="recalls-count">
                        {{ sizeOf(recall.results) }} possible recalls
                    </div>
                </div>
                <div class="matchesList list-group">
                    <h1>Possible recalls</h1>
                    <div class="list-group-item" ng-repeat="match in recall.results | orderBy:matching_score">
                        <h1>{{match.product_description}}</h1>
                        <h2>{{match.recalling_firm}}</h2>
                        <h3>recalled in {{match.city}}, {{match.state}}, {{match.country}} on {{match.recall_initiation_date}}</h3>
                        <p>{{match.reason_for_recall}}</p>
                    </div>
                </div>
            </div>
        </div.
    </div>
    <div ng-show="progress==100 && num_purchases==0">
        <p>We didn't get any purchases from your connected stores. Try <a href="/#/connect">connecting more stores</a>.</p>
    </div>
    <div ng-show="progress==100 && !sizeOf(recalls) && num_purchases>0">
        <p>We checked {{num_checked}} of your {{num_purchases}} purchases, and nothing has been recalled.</p>
    </div>
</div>